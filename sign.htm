<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, remove, get, child } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-database.js";

        const firebaseConfig = {
    apiKey: "AIzaSyBmUK8APKAI0wpDFzZQ8-__cd1JW9lycZQ",
    authDomain: "sign-98b99.firebaseapp.com",
    projectId: "sign-98b99",
    storageBucket: "sign-98b99.appspot.com",
    messagingSenderId: "329383874706",
    appId: "1:329383874706:web:8586cf86db0b9cb641564b"
  };
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        
        submit.addEventListener('click', ()=>{
            if(document.getElementById('name').value && document.getElementById('Cnumber').value && document.getElementById('name').value && document.getElementById('phone').value && document.getElementById('agree').checked==true){
                get(child(ref(database), '/'+document.getElementById('phone').value+'/')).then((snapshot)=>{
                    if(snapshot.exists() == true){
                        alert('이미 등록한 전화번호입니다.');
                    }
                });

                set(ref(database, '/'+document.getElementById('phone').value), {
                class : document.getElementById('class').value,
                Cnumber : document.getElementById('Cnumber').value,
                name : document.getElementById('name').value,
                phone : document.getElementById('phone').value,
            });
                document.getElementById('class').value='';
                document.getElementById('Cnumber').value='';
                document.getElementById('name').value='';
                document.getElementById('phone').value='';
                document.getElementById('agree').value='';
        }
        
    else{
            alert('빠진 내용이 있습니다.');
        }
            });

    //document.getElementById('submit').value='';
            //document.getElementById('submit').focus();
    </script>

</head>
<body>
    <img src="대제.png">

    <h2>대제중학교 청야제 가요제 참가자 신청</h2>
    <div>가요제 참가자 신청</div>
    <input type="text" id="name" placeholder="반/Class">
    <input type="text" id="phone" placeholder="번호/Class Number">
    <input type="text" id="name" placeholder="이름/Name">
    <input type="text" id="phone" placeholder="전화번호/Phone Number">
    <h4>개인정보 수집 동의</h4>
    <div>개인정보 수집 목적: 대제중학교 청야제 가요제 참가자 관리</div>
    <div>개인정보 수집 내용: 반, 번호, 이름, 전화번호</div>
    <div>전화번호 수집 목적: 합격 여부 전달 관리</div>
    <input type="checkbox" id="agree" onClick="console.log(document.getElementById('agree').checked);">
    <label for="agree">개인정보 수집/이용에 동의합니다.</label>
    <button type="submit" id="submit">입장 등록</button>
    <div>청야제 가요제 (9월 29일)</div>
    <div>자세한 정보는 여기서 -> <a href="https://school.cbe.go.kr/daeje-m/" target="_blank">대제중학교 홈페이지</a></div>
</body>
</html>